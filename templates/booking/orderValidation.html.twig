{% extends 'base.html.twig' %}

{% block body %}
    <div class="container">
        <h1 class="text-center"> Thanks for your order !</h1>
        <p>An email has been sent to you with your tickets attached! Thank you and have a good show !!</p>
        <a class="btn btn-info" href="{{ path('home_index') }}">Return to home page</a>
    </div>
    <a href="{{ path('ajax-generate-pdfOrder')}}" class="d-none js-link-to-generate-pdfOrder"></a>
    <a href="{{ path('ajax-send-mail')}}" class="d-none js-link-to-send-mail"></a>
{% endblock %}

{% block javascripts %}
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const linkToGeneratePdfOrder = document.querySelector('a.js-link-to-generate-pdfOrder').href;
        const linkToSendMail = document.querySelector('a.js-link-to-send-mail').href;

        var PdfOrderGenerated = false;

        const generatePdfOrder = () => {
            axios.get(linkToGeneratePdfOrder)
                .then(response => console.log(response.data))
                .then(response => {
                    PdfOrderGenerated = true
                    sendMail();
                })
        }
        const sendMail = () => {
            if(PdfOrderGenerated === true){
                axios.get(linkToSendMail)
                    .then(response => console.log(response.data))
            }
        }

        generatePdfOrder();
    </script>
{% endblock %}